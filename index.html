<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sound Dashboard</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-900 text-white min-h-screen flex items-center justify-center">

<div class="bg-slate-800 p-8 rounded-2xl shadow-2xl w-full max-w-md space-y-6">

<h1 class="text-2xl font-bold text-center">ðŸ“¢ Control Panel</h1>
<div class="text-center text-xs text-slate-400">v1.03</div>

<div class="bg-slate-700 p-4 rounded-xl space-y-3">

<div class="flex justify-between">
<span>Status</span>
<span id="pcStatus">Checking...</span>
</div>

<div class="flex justify-between">
<span>Sound 1</span>
<span id="s1">â€”</span>
</div>

<div class="flex justify-between">
<span>Sound 2</span>
<span id="s2">â€”</span>
</div>

<div class="flex justify-between">
<span>Last update</span>
<span id="lastSeen" class="text-sm text-slate-300">â€”</span>
</div>

</div>

<button id="b1" onclick="trig1()" class="btn">Trigger 1</button>
<button id="b2" onclick="trig2()" class="btn">Trigger 2</button>

</div>

<script>
const BASE="https://troll-lab-default-rtdb.asia-southeast1.firebasedatabase.app/soundSystem";
let online=false;

function btnStyle(on){
return on
?"w-full bg-emerald-600 hover:bg-emerald-700 p-3 rounded-xl"
:"w-full bg-gray-600 cursor-not-allowed p-3 rounded-xl";
}

async function fetchData(){
const r=await fetch(BASE+".json?v="+Date.now());
const d=await r.json();
if(!d)return;

const now=Date.now();
online=false;

if(d.lastSeen){
const last=new Date(d.lastSeen).getTime();
online=(now-last)<=5000;
document.getElementById("lastSeen").textContent=d.lastSeen;
}

document.getElementById("pcStatus").textContent=online?"ONLINE":"OFFLINE";
document.getElementById("pcStatus").className=online?"text-green-400":"text-red-400";

const b1=document.getElementById("b1");
const b2=document.getElementById("b2");
b1.disabled=!online;
b2.disabled=!online;
b1.className=btnStyle(online);
b2.className=btnStyle(online);

if(!online){
document.getElementById("s1").textContent="OFFLINE";
document.getElementById("s2").textContent="OFFLINE";
return;
}

document.getElementById("s1").textContent=d.soundLoaded?"Loaded":"Missing";
document.getElementById("s1").className=d.soundLoaded?"text-green-400":"text-yellow-400";

document.getElementById("s2").textContent=d.soundLoaded2?"Loaded":"Missing";
document.getElementById("s2").className=d.soundLoaded2?"text-green-400":"text-yellow-400";
}

async function trig1(){
if(!online)return;
await fetch(BASE+"/trigger.json",{method:"PUT",body:"true"});
}

async function trig2(){
if(!online)return;
await fetch(BASE+"/trigger2.json",{method:"PUT",body:"true"});
}

setInterval(fetchData,2000);
fetchData();
</script>

</body>
</html>
